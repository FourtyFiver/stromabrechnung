generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id       String @id @default(cuid())
  username String @unique
  password String
}

model PriceConfig {
  id        String   @id @default(cuid())
  validFrom DateTime @default(now())
  priceHT   Float
  priceNT   Float
  baseFee   Float    @default(0.0)
  baseFeeSplit Float @default(50.0)
}

model Reading {
  id            String    @id @default(cuid())
  date          DateTime  @default(now())
  valueHT       Float
  valueNT       Float
  comment       String?
  billedAt      DateTime?
  billPeriodId  String?
  billingNote   String?

  @@index([billedAt])
}

model BillPeriod {
  id             String   @id @default(cuid())
  fromDate       DateTime
  toDate         DateTime
  fromReadingId  String
  toReadingId    String
  totalCost      Float
  energyCost     Float
  baseFeeCost    Float
  billingMonths  Int
  diffHT         Float
  diffNT         Float
  sentAt         DateTime @default(now())
  sentVia        String   @default("telegram")
  pdfGenerated   Boolean  @default(false)
  createdAt      DateTime @default(now())

  @@index([sentAt(sort: Desc)])
}
